<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pronóstico horario</title>
    <link rel="stylesheet" href="/static/css/weather.css">
</head>
<body>

<a href="/main" class="back-link">← Volver al Dashboard</a>

<h2>Pronóstico horario</h2>

<div id="hourly-forecast">

    <!-- Secciones por día -->
    {% for i in range(5) %}
    <div class="day-forecast">
        <h3 id="day-{{ i }}-name">{% if i==0 %}Hoy{% endif %}</h3>
        <div class="hourly-scroll" id="hourly-scroll-{{ i }}">
            <!-- Cada hora se llenará con JS -->
        </div>
    </div>
    {% endfor %}

</div>

<script type="module" src="/static/js/weather.js"></script>
<script type="module">
import { loadWeatherByCoords, getHourlyWeather, renderHourlyForecastByDay } from '/static/js/weather.js';

document.addEventListener("DOMContentLoaded", async () => {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            async (pos) => {
                const lat = pos.coords.latitude;
                const lon = pos.coords.longitude;

                // Cargar clima actual y diario
                await loadWeatherByCoords(lat, lon);

                // Cargar y renderizar pronóstico horario
                const hourlyData = await getHourlyWeather(lat, lon);
                renderHourlyForecastByDay(hourlyData);
            },
            (err) => console.error("No se pudo obtener la ubicación", err),
            { enableHighAccuracy: true }
        );
    } else {
        alert("Geolocalización no soportada");
    }
});
</script>

</body>
</html>